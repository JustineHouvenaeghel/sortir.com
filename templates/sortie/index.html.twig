{% extends 'base.html.twig' %}

{% block title 'Trouvez toutes les sorties organisées !' %}

{% block body %}
    <div class="container">
        <h1>Toutes les sorties</h1>
        <div>
            <form method="get">
                <fieldset class="container">
                    <legend>Filtres</legend>
                    <div class="row">
                        <div class="col-sm-6">
                            <div>
                                <label for="campus">Campus :</label>
                                <select name="campus" id="campus">
                                    <option value="">Tous</option>
                                    {% for c in campus %}
                                        <option value="{{ c.id }}">{{ c.nom }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                            <div>
                                <label for="nom_sortie_contient">
                                    Le nom de la sortie contient :
                                    <input type="text" id="nom_sortie_contient", name="nom_sortie_contient"/>
                                </label>
                            </div>
                            <div>
                                <label for="date_debut">
                                    Entre :
                                    <input type="date" id="date_debut">
                                </label>
                                <label for="date_fin">
                                    et
                                    <input type="date" id="date_fin">
                                </label>
                            </div>
                        </div>
                        <div class="col-sm-6">
                            <label for="sortie_organisateur">
                                <input type="checkbox" id="sortie_organisateur">
                                Sorties dont je suis l'organisateur/trice
                            </label>
                            <br>
                            <label for="sortie_inscrit">
                                <input type="checkbox" id="sortie_inscrit">
                                Sorties auxquelles je suis inscrit/e
                            </label>
                            <br>
                            <label for="sortie_non_inscrit">
                                <input type="checkbox" id="sortie_non_inscrit">
                                Sorties auxquelles je ne suis pas inscrit/e
                            </label>
                            <br>
                            <label for="sorties_passees">
                                <input type="checkbox" id="sorties_passees">
                                Sorties passées
                            </label>
                        </div>
                    </div>
                    <div>
                        <button type="submit">Filtrer ma recherche</button>
                    </div>
                </fieldset>
            </form>
        </div>
        <article>
            <table class="table table-striped">
                <thead>
                <tr>
                    <th scope="col">Nom de la sortie</th>
                    <th scope="col">Date de la sortie</th>
                    <th scope="col">Clôture</th>
                    <th scope="col">Inscrits / Places</th>
                    <th scope="col">Etat</th>
                    <th scope="col">Inscrit</th>
                    <th scope="col">Organisateur</th>
                    <th scope="col">Actions</th>
                </tr>
                </thead>
                <tbody>
                {% for sortie in sorties %}
                    <tr>
                        <td>
                            {{ sortie.nom }}
                        </td>
                        <td>
                            {{ sortie.dateHeureDebut | date('d/m/Y H:m') }}
                        </td>
                        <td>
                            {{ sortie.dateLimiteInscription | date('d/M/Y') }}
                        </td>
                        <td>
                            {{ sortie.participants | length }} / {{ sortie.nbInscriptionMax }}
                        </td>
                        <td>
                            {{ sortie.etat.libelle }}
                        </td>
                        <td>
                            TODO
                        </td>
                        <td>
                            <a href="#">{{ sortie.organisateur.username }}</a>
                        </td>
                        <td>
                            <a href="{{ path('app_sortie_afficher', {id: sortie.id}) }}">Afficher</a>
                            {% if sortie.etat.id < 3 %}
                                {% if app.user.sortiesInscrits == sortie %}
                                    <a href="#">Se désister</a>
                                {% else %}
                                    <a href="#">S'inscrire</a>
                                {% endif %}
                            {% endif %}
                            {% if app.user.username == sortie.organisateur.username and sortie.etat.id <= 3  %}
                                <a href="{{path('app_sortie_modifier', {id: sortie.id})}}">Modifier</a>
                                <a href="#">Publier</a>
                                <a href="#">Annuler</a>
                            {% endif %}
                        </td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
            {{ knp_pagination_render(sorties) }}
            {% if sorties.totalItemCount == 0 %}
                <p>Aucune sortie n'est prévue selon votre critères de recherches.</p>
            {% endif %}
        </article>
    </div>
{% endblock %}
